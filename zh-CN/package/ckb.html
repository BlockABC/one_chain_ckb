<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>@onechain/ckb | One Chain CKB</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="One Chain CKB 是 BlockABC 团队为解决钱包开发中兼容 Nervos CKB 链而设计的 SDK 。">
    <link rel="preload" href="/one_chain_ckb/assets/css/0.styles.6b5f6fd8.css" as="style"><link rel="preload" href="/one_chain_ckb/assets/js/app.c163a8d0.js" as="script"><link rel="preload" href="/one_chain_ckb/assets/js/2.2dc8c2af.js" as="script"><link rel="preload" href="/one_chain_ckb/assets/js/13.390e3204.js" as="script"><link rel="prefetch" href="/one_chain_ckb/assets/js/10.2e773a22.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/11.f12d5cc9.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/12.03e35451.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/14.a835beaf.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/15.e5293e0f.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/3.954ba3ef.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/4.bac36cc7.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/5.848142a4.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/6.bbb9ab75.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/7.54d239e5.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/8.a274f2a6.js"><link rel="prefetch" href="/one_chain_ckb/assets/js/9.64715c25.js">
    <link rel="stylesheet" href="/one_chain_ckb/assets/css/0.styles.6b5f6fd8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/one_chain_ckb/zh-CN/" class="home-link router-link-active"><!----> <span class="site-name">One Chain CKB</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/BlockABC/one_chain_ckb/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  更新日志
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/one_chain_ckb/package/ckb.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/one_chain_ckb/zh-CN/package/ckb.html" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/BlockABC/one_chain_ckb" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/BlockABC/one_chain_ckb/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  更新日志
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/one_chain_ckb/package/ckb.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/one_chain_ckb/zh-CN/package/ckb.html" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/BlockABC/one_chain_ckb" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/one_chain_ckb/zh-CN/" class="sidebar-link">简介</a></li><li><a href="/one_chain_ckb/zh-CN/getting-started.html" class="sidebar-link">开始</a></li><li><a href="/one_chain_ckb/zh-CN/datatype.html" class="sidebar-link">数据类型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Package</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/one_chain_ckb/zh-CN/package/core.html" class="sidebar-link">@onechain/core</a></li><li><a href="/one_chain_ckb/zh-CN/package/ckb.html" class="active sidebar-link">@onechain/ckb</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#class-ckb" class="sidebar-link">Class CKB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#constructor" class="sidebar-link">constructor</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#setkeypairs" class="sidebar-link">setKeypairs</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#setrpcnode" class="sidebar-link">setRPCNode</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#sign" class="sidebar-link">sign</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#buildtransaction" class="sidebar-link">buildTransaction</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#buildautofixtransaction" class="sidebar-link">buildAutoFixTransaction</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#pushtransaction" class="sidebar-link">pushTransaction</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#hdwalletfrommnemonic" class="sidebar-link">hdwalletFromMnemonic</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#hdwalletfromjson" class="sidebar-link">hdwalletFromJSON</a></li></ul></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#class-transaction" class="sidebar-link">Class Transaction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#properties" class="sidebar-link">Properties</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#edit" class="sidebar-link">edit</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#tojson" class="sidebar-link">toJSON</a></li></ul></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#class-hdwallet" class="sidebar-link">Class HDWallet</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#properties-2" class="sidebar-link">Properties</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#derive" class="sidebar-link">derive</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#getkeypairs" class="sidebar-link">getKeypairs</a></li><li class="sidebar-sub-header"><a href="/one_chain_ckb/zh-CN/package/ckb.html#tojson-2" class="sidebar-link">toJSON</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><hr> <blockquote><ul><li>由于参数众多，所有接口的参数都需要以 <code>{}</code> 的形式传递。</li> <li>[param] 表示参数是可选的。</li> <li>CKB 目前的转账金额最少不能低于 6100000000 shannon 。</li></ul></blockquote> <p>这个 package 是主要的接口的实现，推荐使用的导出模块如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token punctuation">{</span> constants<span class="token punctuation">,</span> helper <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./CKB'</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./HDWallet'</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./Transaction'</span>
</code></pre></div><h2 id="class-ckb"><a href="#class-ckb" class="header-anchor">#</a> Class CKB</h2> <h3 id="constructor"><a href="#constructor" class="header-anchor">#</a> constructor</h3> <p>创建 CKB 对象，下面将简称为 provider ，将用于后续创建交易等，是一切的的开始。</p> <h4 id="param"><a href="#param" class="header-anchor">#</a> PARAM</h4> <ul><li>rpcnode: <code>RPCNode</code> ，通过 <code>RPCNode.constructor</code> 创建。</li> <li>[keypairs]: <code>IKeypair[]</code> ，默认为 <code>[]</code> 需要 SDK 使用者自己构造，详见 <a href="https://github.com/BlockABC/one_chain_ckb/blob/develop/packages/core/src/interface.ts" target="_blank" rel="noopener noreferrer">interface.ts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，如果不传可以创建未签名的交易，之后再在需要的时刻进行签名。</li> <li>[logger]: <code>ILogger</code> ，默认为 <code>null</code> ，一个 <code>ILogger</code> 实现，如果不传出错时会看不到任何日志。</li></ul> <h4 id="return"><a href="#return" class="header-anchor">#</a> RETURN</h4> <p>object: <code>IUTXOProvider</code> 详见 <a href="https://github.com/BlockABC/one_chain_ckb/blob/develop/packages/core/src/interface.ts" target="_blank" rel="noopener noreferrer">interface.ts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h4 id="example"><a href="#example" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> rpcnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RPCNode</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConsoleLogger</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CKB</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  rpcnode<span class="token punctuation">,</span>
  keypairs<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> privateKey<span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> privateKey<span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  logger<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="setkeypairs"><a href="#setkeypairs" class="header-anchor">#</a> setKeypairs</h3> <p>修改 provider 内的公私钥对，可以用于切换不同公私钥对签名、延迟传入公私钥对的情况。</p> <h4 id="param-2"><a href="#param-2" class="header-anchor">#</a> PARAM</h4> <ul><li>keypairs: <code>IKeypair[]</code> 需要 SDK 使用者自己构造，详见 <a href="https://github.com/BlockABC/one_chain_ckb/blob/develop/packages/core/src/interface.ts" target="_blank" rel="noopener noreferrer">interface.ts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，如果需要清空请传 <code>[]</code>。</li></ul> <h4 id="return-2"><a href="#return-2" class="header-anchor">#</a> RETURN</h4> <p>void</p> <h4 id="example-2"><a href="#example-2" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CKB</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>

provider<span class="token punctuation">.</span><span class="token function">setKeypairs</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  keypairs<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> privateKey<span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> privateKey<span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="setrpcnode"><a href="#setrpcnode" class="header-anchor">#</a> setRPCNode</h3> <p>修改 provider 内的 RPCNode 实例，可以用于切换不同链。</p> <h4 id="param-3"><a href="#param-3" class="header-anchor">#</a> PARAM</h4> <ul><li>rpcnode: <code>RPCNode</code> ，通过 <code>RPCNode.constructor</code> 创建。</li></ul> <h4 id="return-3"><a href="#return-3" class="header-anchor">#</a> RETURN</h4> <p>void</p> <h4 id="example-3"><a href="#example-3" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CKB</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> rpcnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RPCNode</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>

provider<span class="token punctuation">.</span><span class="token function">setRpcnode</span><span class="token punctuation">(</span><span class="token punctuation">{</span> rpcnode <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="sign"><a href="#sign" class="header-anchor">#</a> sign</h3> <p>对交易进行签名。</p> <h4 id="param-4"><a href="#param-4" class="header-anchor">#</a> PARAM</h4> <ul><li>transaction: <code>RPC.RawTransaction</code> ，CKB RPC 节点可接受的原始交易结构，请不要手工构造，使用 <code>buildTransaction</code> 接口构造。</li> <li>unspents: <code>IUTXOUnspent[]</code> ，详见 <a href="https://github.com/BlockABC/one_chain_ckb/blob/develop/packages/core/src/interface.ts" target="_blank" rel="noopener noreferrer">interface.ts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</li></ul> <h4 id="return-4"><a href="#return-4" class="header-anchor">#</a> RETURN</h4> <p>object: <code>RPC.RawTransaction</code> ，返回值 <code>JSON.stringify</code> 后就可以直接通过 CKB RPC 节点推送了。</p> <h4 id="example-4"><a href="#example-4" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> rawTx <span class="token operator">=</span> provider<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  transaction<span class="token punctuation">,</span>
  unspents<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      txId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
      address<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
      vout<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
      value<span class="token operator">:</span> Decimal<span class="token punctuation">.</span>Value<span class="token punctuation">,</span>
      lock<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
      lockHash<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="buildtransaction"><a href="#buildtransaction" class="header-anchor">#</a> buildTransaction</h3> <p>构造交易。</p> <h4 id="param-5"><a href="#param-5" class="header-anchor">#</a> PARAM</h4> <ul><li>froms: <code>IUTXOFromToParam[]</code> ，详见 <a href="https://github.com/BlockABC/one_chain_ckb/blob/develop/packages/core/src/interface.ts" target="_blank" rel="noopener noreferrer">interface.ts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，转出地址列表，。</li> <li>tos: <code>IUTXOFromToParam[]</code> ，详见 <a href="https://github.com/BlockABC/one_chain_ckb/blob/develop/packages/core/src/interface.ts" target="_blank" rel="noopener noreferrer">interface.ts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，转入地址和金额列表，。</li> <li>changeAddress: <code>string</code> ，找零地址列表， <code>tos</code> 和 <code>froms</code> 之间的差额会被转入到这个地址。</li></ul> <h4 id="return-5"><a href="#return-5" class="header-anchor">#</a> RETURN</h4> <p>object: <code>Transaction</code> ，也就是 <code>Transaction</code> 类的实例。</p> <h4 id="example-5"><a href="#example-5" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> tx <span class="token operator">=</span> <span class="token keyword">await</span> provider<span class="token punctuation">.</span><span class="token function">buildTransaction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  froms<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'A'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'B'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  tos<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'C'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">'6100000000'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'D'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">'6100000000'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  changeAddress<span class="token operator">:</span> <span class="token string">'A'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="buildautofixtransaction"><a href="#buildautofixtransaction" class="header-anchor">#</a> buildAutoFixTransaction</h3> <p>构造交易，和 buildTransaction 稍有不同，如果转出金额超过了余额，会被自动限制在余额之内，需要做到 “转出全部” 的样的效果时就需要这个接口。</p> <h4 id="param-6"><a href="#param-6" class="header-anchor">#</a> PARAM</h4> <ul><li>froms: <code>IUTXOFromToParam[]</code> ，详见 <a href="https://github.com/BlockABC/one_chain_ckb/blob/develop/packages/core/src/interface.ts" target="_blank" rel="noopener noreferrer">interface.ts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，转出地址列表，。</li> <li>tos: <code>IUTXOFromToParam[]</code> ，详见 <a href="https://github.com/BlockABC/one_chain_ckb/blob/develop/packages/core/src/interface.ts" target="_blank" rel="noopener noreferrer">interface.ts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，转入地址和金额列表，。</li> <li>changeAddress: <code>string</code> ，找零地址列表， <code>tos</code> 和 <code>froms</code> 之间的差额会被转入到这个地址。</li></ul> <h4 id="return-6"><a href="#return-6" class="header-anchor">#</a> RETURN</h4> <p>object: <code>Transaction</code> ，也就是 <code>Transaction</code> 类的实例。</p> <h4 id="example-6"><a href="#example-6" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> tx <span class="token operator">=</span> <span class="token keyword">await</span> provider<span class="token punctuation">.</span><span class="token function">buildAutoFixTransaction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  froms<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'A'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'B'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  tos<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'C'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">'6100000000'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'D'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">'6100000000'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  changeAddress<span class="token operator">:</span> <span class="token string">'A'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="pushtransaction"><a href="#pushtransaction" class="header-anchor">#</a> pushTransaction</h3> <p>推送交易。</p> <h4 id="param-7"><a href="#param-7" class="header-anchor">#</a> PARAM</h4> <ul><li>transaction: <code>Transaction | string</code> ，可以是 buildTransaction 接口构造的交易对象，也可以是 CKB RPC 节点接受的原始交易。</li></ul> <h4 id="return-7"><a href="#return-7" class="header-anchor">#</a> RETURN</h4> <p>txId: <code>string</code> ，被推送交易的 ID。</p> <h4 id="example-7"><a href="#example-7" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> tx <span class="token operator">=</span> <span class="token keyword">await</span> provider<span class="token punctuation">.</span><span class="token function">buildAutoFixTransaction</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> txId <span class="token operator">=</span> <span class="token keyword">await</span> provider<span class="token punctuation">.</span><span class="token function">pushTransaction</span><span class="token punctuation">(</span><span class="token punctuation">{</span> transaction<span class="token operator">:</span> tx <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="hdwalletfrommnemonic"><a href="#hdwalletfrommnemonic" class="header-anchor">#</a> hdwalletFromMnemonic</h3> <p>从助记词推导 HD 钱包结构。</p> <h4 id="param-8"><a href="#param-8" class="header-anchor">#</a> PARAM</h4> <ul><li>mnemonic: <code>string</code> ，助记词。</li> <li>path: <code>string</code> ，推导路径，遵循 <a href="https://github.com/satoshilabs/slips/blob/master/slip-0044.md" target="_blank" rel="noopener noreferrer">SLIP-0044<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的路径是 <code>m/44'/309'/0'</code>。</li> <li>needSync: <code>boolean</code> ，默认为 <code>true</code>，是否通过网络同步。</li></ul> <h4 id="return-8"><a href="#return-8" class="header-anchor">#</a> RETURN</h4> <p>object: <code>IUTXOHDWallet</code> ，也就是 <code>HDWallet</code> 类的实例。</p> <h4 id="example-8"><a href="#example-8" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> hdwallet <span class="token operator">=</span> <span class="token keyword">await</span> provider<span class="token punctuation">.</span><span class="token function">hdwalletFromMnemonic</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mnemonic<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
  path<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">m/44'/309'/0'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="hdwalletfromjson"><a href="#hdwalletfromjson" class="header-anchor">#</a> hdwalletFromJSON</h3> <p>从 <code>HDWallet.toJSON</code> 返回的 JSON 数据中回复 <code>HDWallet</code> 实例，通过缓存 JSON 数据可以避免需要每次重新同步 HD 钱包。</p> <h4 id="param-9"><a href="#param-9" class="header-anchor">#</a> PARAM</h4> <ul><li>json: <code>any</code> ， <code>HDWallet.toJSON</code> 的返回值。</li></ul> <h4 id="return-9"><a href="#return-9" class="header-anchor">#</a> RETURN</h4> <p>object: <code>IUTXOHDWallet</code> ，也就是 <code>HDWallet</code> 类的实例。</p> <h4 id="example-9"><a href="#example-9" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> hdwallet <span class="token operator">=</span> <span class="token keyword">await</span> provider<span class="token punctuation">.</span><span class="token function">hdwalletFromMnemonic</span><span class="token punctuation">(</span><span class="token punctuation">{</span> json <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="class-transaction"><a href="#class-transaction" class="header-anchor">#</a> Class Transaction</h2> <h3 id="properties"><a href="#properties" class="header-anchor">#</a> Properties</h3> <ul><li>value: string ，总转出金额。</li> <li>change: string ，总找零金额</li> <li>fee: string ，总矿工费，包含浪费的部分。</li> <li>waste: string ，总浪费金额，也就是无法找零的部分，当找零金额低于 6100000000 shannon 时就会产生。</li> <li>size: string ，当前交易体积。</li> <li>unspents: IUTXOUnspent ，转出地址所有可用的未花费 Cell 。</li> <li>inputs: IUTXOInput ，交易的输入。</li> <li>outputs: IUTXOOutput ，交易的输出。</li> <li>rawTransaction: string ，CKB RPC 节点接受的原始交易数据。</li></ul> <h3 id="edit"><a href="#edit" class="header-anchor">#</a> edit</h3> <p>编辑交易。</p> <h4 id="param-10"><a href="#param-10" class="header-anchor">#</a> PARAM</h4> <ul><li>[fee]: <code>Decimal.Value</code> ，修改矿工费，设置这个参数后 <code>feeRate</code> 就不再生效。</li> <li>[feeRate]: <code>Decimal.Value</code> 修改矿工费费率，以 <strong>shannon/Byte</strong> 计算，如果不知道具体应付多少矿工费就可以使用这个费率值。</li> <li>[tos]: <code>IUTXOFromToParam[]</code> 修改收款地址和金额。</li> <li>[keypairs]: <code>IKeypair[]</code> 修改签名用的公私钥。</li> <li>[changeAddress]: <code>string</code> 修改找零地址。</li></ul> <h4 id="return-10"><a href="#return-10" class="header-anchor">#</a> RETURN</h4> <p>void</p> <h4 id="example-10"><a href="#example-10" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> tx <span class="token operator">=</span> provider<span class="token punctuation">.</span><span class="token function">buildTransaction</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
tx<span class="token punctuation">.</span><span class="token function">edit</span><span class="token punctuation">(</span><span class="token punctuation">{</span> feeRate<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="tojson"><a href="#tojson" class="header-anchor">#</a> toJSON</h3> <p>转为 CKB RPC 节点可直接推送的 JSON 数据。</p> <h4 id="param-11"><a href="#param-11" class="header-anchor">#</a> PARAM</h4> <p>void</p> <h4 id="return-11"><a href="#return-11" class="header-anchor">#</a> RETURN</h4> <p>object: <code>RPC.RawTransaction</code></p> <h4 id="example-11"><a href="#example-11" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> tx <span class="token operator">=</span> provider<span class="token punctuation">.</span><span class="token function">buildTransaction</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> rawTx <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="class-hdwallet"><a href="#class-hdwallet" class="header-anchor">#</a> Class HDWallet</h2> <h3 id="properties-2"><a href="#properties-2" class="header-anchor">#</a> Properties</h3> <ul><li>static ADDRESS_ALL: string ，地址类型</li> <li>static ADDRESS_CHANGE: string ，地址类型</li> <li>static ADDRESS_RECEIVING: string ，地址类型</li> <li>mnemonic: string ，助记词。</li> <li>path: string ，推导的根路径。</li> <li>receiving: IAddress[] ，外链地址。</li> <li>change: IAddress[] ，内链地址。</li></ul> <h3 id="derive"><a href="#derive" class="header-anchor">#</a> derive</h3> <p>推导 HD 钱包结构，当从 JSON 数据中回复 HD 钱包或长时间未使用后，如果希望得出 HD 钱包最新的状态就需要调用这个接口进行推导。</p> <h4 id="param-12"><a href="#param-12" class="header-anchor">#</a> PARAM</h4> <ul><li>[syncfromStart]: <code>boolean</code> ，默认为 <code>false</code> ，是否从头开始推导整个 HD 钱包的结构。</li></ul> <h4 id="return-12"><a href="#return-12" class="header-anchor">#</a> RETURN</h4> <p>void</p> <h4 id="example-12"><a href="#example-12" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> hdwallet <span class="token operator">=</span> provider<span class="token punctuation">.</span><span class="token function">hdwalletFromMnemonic</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> hdwallet<span class="token punctuation">.</span><span class="token function">derive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="getkeypairs"><a href="#getkeypairs" class="header-anchor">#</a> getKeypairs</h3> <p>获得 HD 钱包中的公私钥。</p> <h4 id="param-13"><a href="#param-13" class="header-anchor">#</a> PARAM</h4> <ul><li>[type]: string ，需要获取的地址类型，默认是 <code>HDWallet.ADDRESS_ALL</code></li></ul> <h4 id="return-13"><a href="#return-13" class="header-anchor">#</a> RETURN</h4> <p>array: <code>IKeypair[]</code></p> <h4 id="example-13"><a href="#example-13" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> hdwallet <span class="token operator">=</span> provider<span class="token punctuation">.</span><span class="token function">hdwalletFromMnemonic</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> keypairs <span class="token operator">=</span> hdwallet<span class="token punctuation">.</span><span class="token function">getKeypairs</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> HDWallet<span class="token punctuation">.</span><span class="token constant">ADDRESS_RECEIVING</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="tojson-2"><a href="#tojson-2" class="header-anchor">#</a> toJSON</h3> <p>将 HD 钱包转为可以缓存的 JSON 数据结构。</p> <h4 id="param-14"><a href="#param-14" class="header-anchor">#</a> PARAM</h4> <p>void</p> <h4 id="return-14"><a href="#return-14" class="header-anchor">#</a> RETURN</h4> <p>object: <code>any</code></p> <h4 id="example-14"><a href="#example-14" class="header-anchor">#</a> Example</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> hdwallet <span class="token operator">=</span> provider<span class="token punctuation">.</span><span class="token function">hdwalletFromMnemonic</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> hdwallet<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/one_chain_ckb/zh-CN/package/core.html" class="prev">
        @onechain/core
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/one_chain_ckb/assets/js/app.c163a8d0.js" defer></script><script src="/one_chain_ckb/assets/js/2.2dc8c2af.js" defer></script><script src="/one_chain_ckb/assets/js/13.390e3204.js" defer></script>
  </body>
</html>
